//https://www.luogu.com.cn/problem/P3865
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define max(a,b) (a>b?a:b)
using namespace std;
#define N 100001
#define X 31
int n,m,a,b;
int dp[N][18];
int bin[X],lg2[N];
/*
bin[i]=2^i
dp[i][j]的表示i到i+bin[i]-1范围的数的最大值
下面的图表示dp[i][j]的实际管辖范围，比如(3,3),管辖的就是(3,10)
  0(1) 1(2)    2(4)         3(8)                     4(16)
0 (0) (0,1) (0,1,2,3) (0,1,2,3,4,5,6,7) (0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15)
1 (1) (1,2) (1,2,3,4) (1,2,3,4,5,6,7,8) (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15)
3 (2) (2,3) (2,3,4,5) (2,3,4,5,6,7,8,9) (2,3,4,5,6,7,8,9,10,11,12,13,14,15)
3 (3) (3,4) (3,4,5,6) (3,4,5,6,7,8,9,10) (3,4,5,6,7,8,9,10,11,12,13,14,15)
4 (4) (4,5) (4,5,6,7) (4,5,6,7,8,9,10,11) (4,5,6,7,8,9,10,11,12,13,14,15)
5 (5) (5,6) (5,6,7,8) (5,6,7,8,9,10,11,12) (5,6,7,8,9,10,11,12,13,14,15)
6 (6) (6,7) (6,7,8,9) (6,7,8,9,10,11,12,13) (6,7,8,9,10,11,12,13,14,15)
7 (7) (7,8) (7,8,9,10) (7,8,9,10,11,12,13,14) (7,8,9,10,11,12,13,14,15)
8 (8) (8,9) (8,9,10,11) (8,9,10,11,12,13,14,15)
9 (9) (9,10) (9,10,11,12)
10 (10) (10,11) (10,11,12,13)
11 (11) (11,12) (11,12,13,14)
12 (12) (12,13) (12,13,14,15)
12 (12) (13,14)
13 (13) (13,14)
14 (14) (14,15)
15 (15)
*/
int main(){
    scanf("%d %d\n",&n,&m);
    for(int i=1;i<=n;i++) scanf("%d",&dp[i][0]);
    bin[0]=1;
    for(int i=1;i<X;i++) bin[i]=bin[i-1]*2;//0,1,2,4,8,16...
    lg2[0]=-1;
    for(int i=1;i<N;i++) lg2[i]=lg2[i/2]+1;
    for(int i=1;i<=lg2[n];i++){//建立dp的时候我们一列一列构建
        for(int j=1;j<=n;j++){
            if(j+bin[i]-1<=n) dp[j][i]=max(dp[j][i-1],dp[j+bin[i-1]][i-1]);
        }
    }
    for(int x=0;x<m;x++){
        scanf("%d %d\n",&a,&b);
        int t=b-a+1;
        int lg=lg2[t];
        printf("%d\n",max(dp[a][lg],dp[b-bin[lg]+1][lg]));
        //dp[a][lg]的管辖范围[ a, a+bin[lg]-1 ]
        //dp[b-bin[lg]+1][lg]的管辖范围 [ b-bin[lg]+1, b-bin[lg]+1+bin[lg]-1=b ]==[ b-bin[lg]+1, b]
        //两者合并起来就是[ a, b]这个区间
    }
    return 0;
}